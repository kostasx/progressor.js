!function(a,b){"undefined"!=typeof module?module.exports=b():"function"==typeof define&&"object"==typeof define.amd?define(b):this[a]=b()}("Progressor",function(){function a(a){var b=null;this._isYt=!1,this._media=a.media,a.media.driver&&a.media.driver._ytEl&&(b=a.media.driver._ytEl,this._isYt=!0,this._media.getCurrentTime=b.getCurrentTime.bind(b),this._media.duration=b.getDuration.call(b)),this._media=a.media,this._bar=a.bar,this._text=a.text,this._time=a.time,this._hours=a.hours,this.initProgressBar(),this.initMedia()}return a.prototype.initYouTubeInterval=function(){this._isYt&&(this.ytInterval=setInterval(function(){this._media.currentTime=this._media.getCurrentTime(),this.updateProgress.call(this),this.updateTimeCount.call(this)}.bind(this),500))},a.prototype.initMedia=function(){this._isYt||(this._media.addEventListener("timeupdate",this.updateProgress.bind(this),!1),this._media.addEventListener("timeupdate",this.updateTimeCount.bind(this),!1)),this.initYouTubeInterval(),this.addClickEvents(),this.updateTimeCount(this._media)},a.prototype.initProgressBar=function(){this._textBox=document.createElement("span"),this._textBox.textContent=this._text||"",this._bar.style.position="relative",this._bar.style.zIndex=1,this._bar.className=this._bar.className+" progressor",this._progress=document.createElement("div"),this._progress.className="progressor-progress",this._progress.style.width="0%",this._progress.style.height="100%",this._progress.style.position="absolute",this._progress.style.top=0,this._progress.style.zIndex=-1,this._bar.style.webkitUserSelect="none",this._bar.style.userSelect="none",this._bar.appendChild(this._textBox),this._bar.appendChild(this._progress)},a.prototype.updateProgress=function(){this.updateTimeCount();var a=0,b=this._media.currentTime;b>0&&(a=100/this._media.duration*b),this._bar.getElementsByTagName("div")[0].style.width=a+"%"},a.prototype.formatTime=function(a){var b=Math.floor(a/3600).toString();if(this._hours){var c=("0"+Math.floor(a/60)%60).slice(-2),d=("0"+Math.floor(a%60)).slice(-2);return"0"!==b?b+":"+c+":"+d:c+":"+d}var c=Math.floor(a/60),d=("0"+Math.round(a-60*c)).slice(-2);return c+":"+d},a.prototype.updateTimeCount=function(){if(this._time){var a=this._media.currentTime;a=this.formatTime(a);var b=this.formatTime(this._media.duration);isNaN(this._media.duration)===!0&&(b="00:00"),this._time.innerHTML=a+"/"+b}},a.prototype.timeFromCursorPosition=function(a,b,c){var d=a.getBoundingClientRect(),e=b.clientX-d.left,f=e/d.width;return f*c},a.prototype.setMediaProgress=function(a){this._media.currentTime=this.timeFromCursorPosition(this._bar,a,this._media.duration),this.updateProgress()},a.prototype.remove=function(){function a(a){var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a)}this._time.innerHTML="",this._bar.removeChild(this._textBox),this._bar.removeChild(this._progress),this._bar.style.position="",this._bar.style.zIndex="",this._bar.style.webkitUserSelect="",this._bar.style.userSelect="",this._bar.classList.remove("progressor"),a(this._bar),a(this._media)},a.prototype.addClickEvents=function(){var a=!1,b=!1,c="",d=function(c){a=!0,b=this._isYt?!(2==this._media.driver._ytEl.getPlayerState()):!this._media.paused,this._media.pause(),this._isYt&&(this._media.driver._ytEl.pauseVideo(),clearInterval(this.ytInterval)),this.setMediaProgress(c)},e=function(d){clearInterval(c),a=!1,1==b&&(this._media.play(),b=!1),this._isYt&&(this._media.driver._ytEl.seekTo(this._media.currentTime),this.initYouTubeInterval())},f=function(b){a===!0&&(c=setInterval(this.setMediaProgress(b),1e3))};this._bar.addEventListener("mousedown",d.bind(this)),document.addEventListener("mouseup",e.bind(this)),document.addEventListener("mousemove",f.bind(this))},a});